---
title: "new york city _ case for class"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{new york city}
  %\VignetteEncoding{UTF-8}
  %\VignetteEngine{knitr::rmarkdown}
editor_options: 
  chunk_output_type: console
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
library(USF)
library(sf)
library(rgdal)
library(tmap)
library(tidyverse)
```


# NYC Complaints
```{r}
# Police Misconduct (NYCLU)
data(nyc_complaints) 

# Precinct with most complaints
precint_complaints <- nyc_complaints %>% group_by(Precinct) %>% count() # spatialize by precinct.shp
precint_complaints %>% arrange(-n)
precint_complaints %>% arrange(n)

# Allegation of misconduct

nyc_complaints %>% group_by(FADOType) %>% count()

# date distribution

max(nyc_complaints$IncidentDate)


# Sites of abuse/threat/misconduct

nyc_complaints %>% group_by(LocationType) %>% count() %>% arrange(n)

# Rule

nyc_complaints$NYPDDisposition %>% unique()

#nyc_complaints %>% 
#  filter( grepl("Guilty", NYPDDisposition))


# "Impacted .." demographics

nyc_complaints %>% group_by(ImpactedRace) %>% count() %>% arrange(-n)

nyc_complaints %>% group_by(ImpactedGender) %>% count() %>% arrange(-n)

nyc_complaints %>% group_by(ImpactedAge) %>% count() %>% arrange(-n) #very weird numbers towards the top



# Select misconducts based on query

allegations_sample <- nyc_complaints %>% 
  filter( grepl("Refusal", Allegation) | 
            grepl("Threat", Allegation) | 
    grepl("Statement", Allegation) | 
  grepl("Sex", Allegation))



```

